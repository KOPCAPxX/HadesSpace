import{d as te,s as le,aI as oe,g as ie,i as C,j as ne,y as ae,D as de,z as ue,x as pe,r as re,o as p,b as r,e as u,h as S,f as o,t as c,u as i,H as ce,w as f,F as h,B as M,S as g,M as T,A as U,I as k,aN as q,E as $,p as ve,q as me,_ as _e}from"./index-a8WEG3No.js";import{g as fe,m as A}from"./ModulePage.vue_vue_type_script_setup_true_lang-HwHUTCO7.js";import{M as H,a as he}from"./MultiConfigGUI-mlXJcqSq.js";import{c as Ce}from"./compendiumTechList-3ibqvCjn.js";import{b as Se}from"./byTypes-1BYQ2hUk.js";import{g as Ie}from"./globals-zpsYnYkF.js";import{s as P}from"./capital_ships-ioQeNDqF.js";import{T as x}from"./TechList-qnFBIiLB.js";import{N as ye}from"./NumberPicker-dkYAT3nM.js";import{o as Me}from"./Data-dq2GvIC6.js";import"./Page-F76NhfCg.js";import"./spacebuildings-NmTc9Pj4.js";import"./sec2str-k4xRjo2W.js";const ge=L=>(ve("data-v-2de3ee49"),L=L(),me(),L),Te={class:"container"},Le={class:"topic"},De={class:"buttons"},Ee={class:"ship-list"},be=["onClick"],ke={class:"icon"},Oe={class:"body"},Ne={class:"modules"},Be={key:0,class:"level"},Ue={class:"create-ship-list"},$e=["onClick"],Ae=["onUpdate:modelValue"],He=["value"],Pe={class:"edit-ship"},we={class:"modal-module"},ze={class:"title"},Re={class:"level-picker"},Ge={class:"module-levels"},Ve={class:"select"},je={class:"name"},Ye={value:{provider:null}},qe={value:{provider:"Edit"}},xe={disabled:""},Fe=["value"],Ke={disabled:""},We=ge(()=>o("option",{value:{provider:"HSCompendium",index:0}}," 0 ",-1)),Ze="shipBuild",Je="modulesCalc",Qe=te({__name:"ShipBuild",setup(L){const m={levels:{Transport:1,Miner:1,Battleship:1},ships:[]},I={Battleship:P.Battleship,Transport:P.Transport,Miner:P.Miner},{MaxModuleLevel:F}=Ie,K=Me(A,{map:([l,e])=>[l,fe(e)]}),w=le(),z=oe(),{t:W}=ie(),{data:Z,levelMap:R}=Ce(),t=new H(Ze,m),G=new H(Je,{}),V=W("SHIP_BUILD"),j=Object.keys(I),D=C(!1),O=C(!1),E=C(!1),N=C(!1),B=C(!1),y=C(w.state.userSettings.shipBuildSync),a=ne({data:{hideModulesTypes:[],removeShip:()=>{},ship:{slots:[]},module:{Name:"",Icon:"",TID:""},updateModule:()=>{}}});if(Y(),z.currentRoute.value.query.d){const e={...H.parseUrl(z.currentRoute.value.query.d)};t.add(e,{temporary:!0})}ae(async()=>{await de()}),ue(R,l=>{y.value.provider=="HSCompendium"&&(t.selectedConfig.levels={...l})});function J(l){t.selectedConfig.ships.push({meta:{type:l},slots:[]}),t.selectedConfig.ships.sort((e,d)=>j.indexOf(e.meta.type)-j.indexOf(d.meta.type)),t.save(),D.value=!1}function Q(l){const e=t.selectedConfig.ships[l],{levels:d}=t.selectedConfig,s=[],{NewModuleSlots:n}=I[e.meta.type];typeof n=="string"?s.push(...Array(d[e.meta.type]).fill(n)):Array.isArray(n)&&s.push(...n.slice(0,d[e.meta.type]).flat()),e.slots.length||(e.slots=s),a.data.ship=e,a.data.hideModulesTypes=Se.artifact.filter(_=>!s.includes(_)),a.data.removeShip=()=>{t.selectedConfig.ships.splice(l,1),t.save(),E.value=!1},t.save(),E.value=!0}function X(l){return a.data.ship.slots.includes(l)}function ee({SlotType:l,Name:e}){const d=a.data.ship.slots.indexOf(e);if(d!=-1)a.data.ship.slots[d]=l;else{const s=a.data.ship.slots.indexOf(l);s!=-1&&(a.data.ship.slots[s]=e)}t.save()}function se(l){a.data.module=l,a.data.updateModule=e=>{t.selectedConfig.levels[l.Name]=e,t.save()},N.value=!0}function Y(){var d,s,n,_,v,b;const{provider:l,index:e}=y.value;l=="ModulesCalc"&&(t.selectedConfig.levels={Transport:((s=(d=t==null?void 0:t.selectedConfig)==null?void 0:d.levels)==null?void 0:s.Transport)??m.levels.Transport,Miner:((_=(n=t==null?void 0:t.selectedConfig)==null?void 0:n.levels)==null?void 0:_.Miner)??m.levels.Miner,Battleship:((b=(v=t==null?void 0:t.selectedConfig)==null?void 0:v.levels)==null?void 0:b.Battleship)??m.levels.Battleship,...G.store.configs[e].value.actually}),l=="HSCompendium"&&(t.selectedConfig.levels={...R}),l==null&&Object.keys(t.selectedConfig.levels).length!=Object.keys(m.levels).length&&(t.selectedConfig.levels={...m.levels}),w.commit(pe.SET_SHIP_BUILD_SYNC,y.value),t.save()}return(l,e)=>{const d=re("t");return p(),r("div",Te,[u(i(ce),null,{default:S(()=>[o("title",null,c(i(V)),1)]),_:1}),o("h1",Le,c(i(V)),1),o("div",De,[o("button",{class:"settings-btn",onClick:e[0]||(e[0]=s=>B.value=!0)}),f(o("button",{class:"button accent",onClick:e[1]||(e[1]=s=>D.value=!0)},null,512),[[d,"TID_PC_NEW_SHIP"]]),f(o("button",{class:"button accent",onClick:e[2]||(e[2]=s=>O.value=!0)},null,512),[[d,"TID_MODULE_LEVEL_HINT_TITLE"]])]),o("ul",Ee,[(p(!0),r(h,null,M(i(t).selectedConfig.ships,({meta:{type:s},slots:n},_)=>(p(),r("li",{key:`${s}${_}`,class:"ship",onClick:v=>Q(_)},[o("div",ke,[u(k,{dir:"game/Ships",name:I[s].Model[i(t).selectedConfig.levels[s]-1]},null,8,["name"])]),o("div",Oe,[f(o("p",null,null,512),[[d,I[s].TID]]),o("ul",Ne,[(p(!0),r(h,null,M(n,(v,b)=>(p(),r("li",{key:`${v}${b}`},[v in i(A)?(p(),r(h,{key:0},[u(k,{dir:"game/Modules",name:i(A)[v].Icon},null,8,["name"]),i(t).selectedConfig.levels[v]?(p(),r("span",Be,c(i(t).selectedConfig.levels[v]),1)):$("",!0)],64)):$("",!0)]))),128))])])],8,be))),128))]),u(T,{open:D.value,"onUpdate:open":e[4]||(e[4]=s=>D.value=s),title:l.$t("TID_PC_NEW_SHIP"),size:i(g).SMALL},{body:S(()=>[o("ul",Ue,[(p(),r(h,null,M(I,s=>o("li",{key:s.Name,class:"ship"},[o("div",{class:"icon",onClick:n=>J(s.Name)},[u(k,{dir:"game/Ships",name:s.Model[i(t).selectedConfig.levels[s.Name]-1]},null,8,["name"])],8,$e),o("div",{class:U(["select",{disable:l.$store.state.userSettings.shipBuildSync.provider=="HSCompendium"}])},[f(o("select",{"onUpdate:modelValue":n=>i(t).selectedConfig.levels[s.Name]=n,onChange:e[3]||(e[3]=(...n)=>i(t).save&&i(t).save(...n))},[(p(!0),r(h,null,M(s.BuildCost.length,n=>(p(),r("option",{key:n,value:n},c(n),9,He))),128))],40,Ae),[[q,i(t).selectedConfig.levels[s.Name]]])],2)])),64))])]),_:1},8,["open","title","size"]),u(T,{open:E.value,"onUpdate:open":e[6]||(e[6]=s=>E.value=s),title:l.$t("TID_CORP_DIALOG_EDIT"),size:i(g).LARGE},{body:S(()=>[o("div",Pe,[o("div",{class:U(["tech-list",a.data.hideModulesTypes])},[u(x,{"is-muted":X,"on-click":ee})],2),f(o("button",{class:"button red",onClick:e[5]||(e[5]=(...s)=>a.data.removeShip&&a.data.removeShip(...s))},null,512),[[d,"TID_DISBAND_SHIP_BUTTON"]])])]),_:1},8,["open","title","size"]),u(T,{open:N.value,"onUpdate:open":e[7]||(e[7]=s=>N.value=s),title:l.$t("TID_CORP_DIALOG_EDIT"),size:i(g).SMALL},{body:S(()=>[o("div",we,[o("div",ze,[o("div",null,[o("h2",null,c(l.$t(a.data.module.TID)),1)]),u(k,{name:a.data.module.Icon,dir:"game/Modules"},null,8,["name"])]),o("div",Re,[u(ye,{value:i(t).selectedConfig.levels[a.data.module.Name]||0,min:i(K)[a.data.module.Name],max:i(F),"onUpdate:value":a.data.updateModule},null,8,["value","min","max","onUpdate:value"])])])]),_:1},8,["open","title","size"]),u(T,{open:O.value,"onUpdate:open":e[9]||(e[9]=s=>O.value=s),title:l.$t("TID_MODULE_LEVEL_HINT_TITLE"),size:i(g).LARGE},{body:S(()=>[o("div",Ge,[o("div",Ve,[f(o("p",je,null,512),[[d,"SYNC"]]),f(o("select",{"onUpdate:modelValue":e[8]||(e[8]=s=>y.value=s),onChange:Y},[o("option",Ye,c(l.$t("TID_PLAYER_INFO_CORP_NONE")),1),o("option",qe,c(l.$t("TID_CORP_DIALOG_EDIT")),1),o("option",xe,"--- "+c(l.$t("MODULES_CALC"))+" ---",1),(p(!0),r(h,null,M(i(G).store.configs,(s,n)=>(p(),r("option",{key:n,value:{provider:"ModulesCalc",index:n}},c(s.name),9,Fe))),128)),i(Z)?(p(),r(h,{key:0},[o("option",Ke,"--- "+c(l.$t("HS_COMPENDIUM"))+" ---",1),We],64)):$("",!0)],544),[[q,y.value]])]),o("div",{class:U(["tech-list",{disable:l.$store.state.userSettings.shipBuildSync.provider!="Edit"}])},[u(x,{"level-map":i(t).selectedConfig.levels,"on-click":se},null,8,["level-map"])],2)])]),_:1},8,["open","title","size"]),u(T,{open:B.value,"onUpdate:open":[e[10]||(e[10]=s=>B.value=s),e[11]||(e[11]=()=>i(t).save())],title:l.$t("TID_SETTINGS_DLG_TITLE"),size:i(g).MEDIUM},{body:S(()=>[u(he,{"on-create-new":()=>i(t).add(m),instance:i(t)},null,8,["on-create-new","instance"])]),_:1},8,["open","title","size"])])}}}),cs=_e(Qe,[["__scopeId","data-v-2de3ee49"]]);export{cs as default};
