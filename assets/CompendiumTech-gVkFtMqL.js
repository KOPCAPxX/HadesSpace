import{d as w,j as H,k as c,g as q,l as f,m as z,S as F,n as G,q as K,s as X,r as Y,o as Z,c as J,h,e as r,f as s,t as _,u as I,H as Q,w as W,v as ee,M as te,x as ae,y as B,z as g,I as T,p as ne,i as se,_ as le}from"./index-dHtEVPo8.js";import{T as oe,C as ie}from"./CompendiumTechList-CzDzu17S.js";import{N as ce}from"./NumberPicker-AtLSQqOR.js";import{g as re}from"./globals-zpsYnYkF.js";import{s as L}from"./capital_ships-ioQeNDqF.js";import{a as ue}from"./alliance_levels-o1qIIhIq.js";import{s as D}from"./spacebuildings-NmTc9Pj4.js";import{m as b}from"./ModulePage.vue_vue_type_script_setup_true_lang-X9_8ZXi8.js";import{o as de}from"./Data-onoDaSTt.js";import"./TheConfirm-v4H_DoDk.js";import"./byTypes-1BYQ2hUk.js";import"./Page-I74HW2lx.js";import"./sec2str-rCAbwORc.js";const me=u=>(ne("data-v-739e2af6"),u=u(),se(),u),pe={class:"container"},ve={class:"modal"},fe={class:"title"},he=me(()=>s("div",null,null,-1)),_e={class:"level-picker"},Ie=w({__name:"CompendiumTech",setup(u){const M={RedStarScanner:D.RedStarScanner,ShipmentRelay:D.ShipmentRelay},A={Transport:L.Transport,Miner:L.Miner,Battleship:L.Battleship},{MaxModuleLevel:S}=re,N=Object.fromEntries([...Object.entries(M).map(([e,t])=>[e,t.Cost.length]),...Object.entries(A).map(([e,t])=>[e,t.BuildCost.length]),...Object.keys(b).map(e=>[e,S]),["AllianceLevel",ue.XPRequired.length]]),x=Object.fromEntries([...Object.keys(M).map(e=>[e,0]),...Object.keys(A).map(e=>[e,0]),...Object.entries(b).map(([e,t])=>[e,$(t)]),["AllianceLevel",0]]),C=H((...e)=>c.setTechLevel(...e),500),{t:o}=q(),E=o("HS_COMPENDIUM"),d=f(!1),n=f(null),p=f({}),a=z({size:F.SMALL,title:o("TECHNOLOGIES"),data:{value:{},maxLevel:0,minLevel:0,lastAgoUpdate:0,get key(){return this.value.Name}}}),k=setInterval(v,5e3);G(()=>{c.getUser()&&(n.value=c.getTechLevels())}),K(()=>{clearTimeout(k)}),X(n,e=>{e&&(p.value=de(e,{map:([t,l])=>[ae(t),l.level]}))},{deep:!0}),c.on("sync",e=>n.value=e),c.on("connected",()=>n.value=c.getTechLevels()),c.on("disconnected",()=>{n.value=void 0,p.value=void 0});function j(e){n.value&&(a.data.value=e,a.data.maxLevel=N[e.Name],a.data.minLevel=x[e.Name],d.value=!0,v())}function R(e){var t;return!((t=m(e))!=null&&t.level)}function U(e){const t=B(a.data.key);return n.value[t]||(n.value[t]={level:0}),a.data.minLevel!=0&&e==a.data.minLevel&&n.value[t].level!=0&&(e=0),n.value[t].level!=e&&(n.value[t].level=e,C(t,e),v()),e}function $(e){let t=1;for(const[,l]of Object.entries(e))Array.isArray(l)&&l.length>t&&(t=l.length);return S-t+1}function m(e){var t;return((t=n.value)==null?void 0:t[B(e)])||null}function P(){var t;const e=a.data.value;if(e.Icon)return g(T,{name:e.Icon,dir:e.specialIcon?"icons":"game/Modules"});if(e.Model)return g(T,{name:e.Model[((t=m(e.Name))==null?void 0:t.level)-1||5],dir:"game/Ships"});if(e.PrefabModel)return g(T,{name:e.PrefabModel,dir:"game/SpaceBuildings"})}function v(){var e;if(d.value){const t=(e=m(a.data.key))==null?void 0:e.ts;t&&(a.data.lastAgoUpdate=(new Date-t)/1e3)}}function V(e){const t=[],l=Math.trunc(e/86400),i=Math.trunc(e%86400/3600),y=Math.trunc(e%3600/60),O=Math.trunc(e%60);return l!=0&&t.push(`${l}${o("TID_DAY_ABBREVIATION")}`),i!=0&&t.push(`${i}${o("TID_HOUR_ABBREVIATION")}`),y!=0&&t.push(`${y}${o("TID_MINUTE_ABBREVIATION")}`),O!=0&&t.push(`${O}${o("TID_SECOND_ABBREVIATION")}`),t.slice(0,2).join(" ")}return(e,t)=>{const l=Y("t");return Z(),J(ie,null,{default:h(()=>[r(I(Q),null,{default:h(()=>[s("title",null,_(I(E)),1)]),_:1}),s("div",null,[s("div",pe,[r(oe,{"on-click":j,"is-muted":R,"level-map":p.value},null,8,["level-map"])]),r(te,ee({open:d.value,"onUpdate:open":t[0]||(t[0]=i=>d.value=i)},a),{body:h(()=>{var i;return[s("div",ve,[s("div",fe,[s("div",null,[s("h2",null,_(e.$t(a.data.value.TID)),1),s("p",null,_(I(o)("TID_SOCIAL_TIMESTAMP",[V(a.data.lastAgoUpdate)])),1),he]),r(P)]),W(s("span",null,null,512),[[l,"CURRENT_LVL"]]),s("div",_e,[r(ce,{value:((i=m(a.data.key))==null?void 0:i.level)||0,min:a.data.minLevel,max:a.data.maxLevel,"onUpdate:value":U},null,8,["value","min","max"])])])]}),_:1},16,["open"])])]),_:1})}}}),Ce=le(Ie,[["__scopeId","data-v-739e2af6"]]);export{Ce as default};
