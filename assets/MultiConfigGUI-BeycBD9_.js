var F=Object.defineProperty;var U=(n,s,t)=>s in n?F(n,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[s]=t;var y=(n,s,t)=>(U(n,typeof s!="symbol"?s+"":s,t),t);import{j as $,aG as D,aM as G,d as k,s as j,g as B,i as J,a as P,r as K,o as w,b as N,f as u,w as _,A as z,t as L,aN as V,F as H,B as Y,J as Z,K as q,_ as Q}from"./index-2IOqT4GS.js";const M={crush:(n,s=50)=>{const t="",l=(e,a)=>{let h=a.length,d="";const b=r=>encodeURI(encodeURIComponent(r)).replace(/%../g,"i").length,A=r=>{let c=r.charCodeAt(0),f=r.charCodeAt(r.length-1);return c>=56320&&c<=57343||f>=55296&&f<=56319};let m={};for(let r=2;r<s;r++)for(let c=0;c<e.length-r;++c){let f=e.substr(c,r);if(m[f]||A(f))continue;let O=1;for(let v=e.indexOf(f,c+r);v>=0;++O)v=e.indexOf(f,v+r);O>1&&(m[f]=O)}for(;;){for(;h--&&e.includes(a[h]););if(h<0)break;let r=a[h],c,f=0,O=b(r);for(let I in m){let S=m[I],C=(S-1)*b(I)-(S+1)*O;d.length||(C-=b(t)),C<=0?delete m[I]:C>f&&(c=I,f=C)}if(!c)break;e=e.split(c).join(r)+r+c,d=r+d;let v={};for(let I in m){let S=I.split(c).join(r),C=0;for(let E=e.indexOf(S);E>=0;++C)E=e.indexOf(S,E+S.length);C>1&&(v[S]=C)}m=v}return{a:e,b:d}};let o=[];const i="-_.!~*'()";for(let e=127;--e;)(e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122||i.includes(String.fromCharCode(e)))&&o.push(String.fromCharCode(e));for(let e=32;e<255;++e){let a=String.fromCharCode(e);a!="\\"&&!o.includes(a)&&o.unshift(a)}n=n.replace(new RegExp(t,"g"),""),n=R(n);const g=l(n,o);let p=g.a;return g.b.length&&(p+=t+g.b),p+="_",p},uncrush:n=>{n=n.substring(0,n.length-1);const s=n.split("");let t=s[0];if(s.length>1){let l=s[1];for(let o of l){let i=t.split(o);t=i.join(i.pop())}}return R(t,0)}},R=(n,s=1)=>{const t=[['"',"'"],["':","!"],[",'","~"],["}",")","\\","\\"],["{","(","\\","\\"]],l=(o,i)=>{let g=new RegExp(`${(i[2]?i[2]:"")+i[0]}|${(i[3]?i[3]:"")+i[1]}`,"g");return o.replace(g,p=>p===i[0]?i[1]:i[0])};if(s)for(let o=0;o<t.length;++o)n=l(n,t[o]);else for(let o=t.length;o--;)n=l(n,t[o]);return n},x="default entry",T="en";class W{constructor(s,t){y(this,"store");y(this,"TIDs",{});this.localStoreKey=s,this.zeroConfig=t,this.store=$({configs:[],selected:0}),this.load()}get selectedConfig(){return this.store.configs[this.store.selected].value}load(){const s=JSON.parse(localStorage.getItem(this.localStoreKey)||"{}");if(s){if(s.configs){Object.assign(this.store,s);return}localStorage.removeItem(this.localStoreKey)}this.add(this.zeroConfig)}save(){localStorage.setItem(this.localStoreKey,JSON.stringify(this.store))}removeSelected(){if(this.store.configs.splice(this.store.selected,1),this.store.configs.length==0){this.add(this.zeroConfig);return}this.store.selected=this.store.configs.length-1}add(s,{temporary:t}={temporary:!1}){let l=0,o;do o=l?`${x} #${l}`:x,l++;while(this.store.configs.length&&this.store.configs.some(i=>i.name==o));this.store.configs=[...this.store.configs,{name:o,value:s}],this.store.selected=this.store.configs.length-1,t||this.save()}async parseString(s){const t=[];D.global.availableLocales.includes(T)||await G(T);for(const[l,o]of Object.entries(this.TIDs)){const i=D.global.t(o,T),g=new RegExp(`${i}\\s+?(\\d+)\\s?`,"mi"),[,p]=s.match(g)||[void 0,"0"];t.push([l,parseInt(p)])}return Object.fromEntries(t.filter(([,l])=>l))}static stringifyUrl(s){const t=JSON.stringify(s);return M.crush(t)}static parseUrl(s){return JSON.parse(M.uncrush(s))}}const X={class:"container"},ee={class:"config-category"},te={class:"flex-end"},se={class:"select"},oe={class:"name"},ne=["value"],le={class:"input"},ie={class:"name"},re=["placeholder"],ae={class:"flex-end margin-bottom"},ce=k({__name:"MultiConfigGUI",props:{instance:{},onCreateNew:{type:Function},dataToString:{}},setup(n){const s=j(),{t}=B(),l=n,o=J({text:t("COPY"),color:"yellow"}),i=P(()=>`${location.origin}${location.pathname}`);function g(){const e=W.stringifyUrl(l.dataToString??l.instance.selectedConfig);navigator.clipboard.writeText(`${i.value}?d=${e}`).then(()=>{o.value={text:t("COPIED"),color:"green"},setTimeout(()=>o.value={text:t("COPY"),color:"yellow"},2e3)}).catch(a=>{o.value={text:t("TID_DLG_TITLE_ERROR"),color:"red"},alert(a.message),console.error(a)})}async function p(){const{name:e}=l.instance.store.configs[l.instance.store.selected];await s.dispatch(q.OPEN_CONFIRM,t("REMOVE_CONFIG",[e])).then(()=>{l.instance.removeSelected()}).catch(()=>{})}return(e,a)=>{const h=K("t");return w(),N("div",X,[u("div",ee,[_(u("p",null,null,512),[[h,"CONFIG"]]),u("div",te,[u("button",{class:z(`button ${o.value.color}`),onClick:g},L(o.value.text),3),_(u("button",{class:"button green",onClick:a[0]||(a[0]=(...d)=>e.onCreateNew&&e.onCreateNew(...d))},null,512),[[h,"CREATE"]])])]),u("div",se,[_(u("p",oe,null,512),[[h,"LIST"]]),_(u("select",{"onUpdate:modelValue":a[1]||(a[1]=d=>e.instance.store.selected=d)},[(w(!0),N(H,null,Y(e.instance.store.configs,(d,b)=>(w(),N("option",{key:b,value:b},L(d.name),9,ne))),128))],512),[[V,e.instance.store.selected]])]),u("div",le,[_(u("p",ie,null,512),[[h,"TID_CHANGE_NAME_TITLE"]]),_(u("input",{"onUpdate:modelValue":a[2]||(a[2]=d=>e.instance.store.configs[e.instance.store.selected].name=d),placeholder:e.$t("TID_CORP_NAME_LABEL")},null,8,re),[[Z,e.instance.store.configs[e.instance.store.selected].name]])]),u("div",ae,[_(u("button",{class:"button red",onClick:p},null,512),[[h,"TID_SOCIAL_DELETE_MESSAGE"]])])])}}}),fe=Q(ce,[["__scopeId","data-v-fdcb7439"]]);export{W as M,fe as a};
