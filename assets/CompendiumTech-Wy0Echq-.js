import{d as N,o as $,b as z,f as n,_ as E,j as F,k as d,g as G,l as L,m as K,S as X,n as Y,q as Z,s as J,r as Q,c as W,h as M,e as v,t as A,u as S,H as ee,w as te,v as ae,M as ne,x as se,y as x,z as y,I as b,p as le,i as oe}from"./index-5XVOQWzF.js";import{T as ie,C as ce}from"./CompendiumTechList-oG4ovU03.js";import{g as re}from"./globals-zpsYnYkF.js";import{s as O}from"./capital_ships-POjy6D0o.js";import{a as ue}from"./alliance_levels-o1qIIhIq.js";import{s as D}from"./spacebuildings-NmTc9Pj4.js";import{m as C}from"./ModulePage.vue_vue_type_script_setup_true_lang-O9IEaFQC.js";import{o as de}from"./Data-9TaLWwap.js";import"./TheConfirm-zvZiViq-.js";import"./byTypes-1BYQ2hUk.js";import"./Page-wvvXd9_K.js";import"./sec2str-xTG3Lnk0.js";const me={class:"container"},pe={class:"input-wrap"},ve=["value"],fe=N({__name:"NumberPicker",props:{value:{},min:{},max:{}},emits:["update:value"],setup(m,{emit:f}){const i=m,h=f;function p(c){c<i.min&&(c=i.min),c>i.max&&(c=i.max),h("update:value",c)}return(c,r)=>($(),z("div",me,[n("div",{class:"minus",onClick:r[0]||(r[0]=l=>p(i.value-1))}),n("div",pe,[n("input",{type:"text",value:c.value,onChange:r[1]||(r[1]=l=>p(parseInt(l.target.value)))},null,40,ve)]),n("div",{class:"plus",onClick:r[2]||(r[2]=l=>p(i.value+1))})]))}}),he=E(fe,[["__scopeId","data-v-e8dab759"]]),_e=m=>(le("data-v-739e2af6"),m=m(),oe(),m),Ie={class:"container"},ge={class:"modal"},Te={class:"title"},Le=_e(()=>n("div",null,null,-1)),Me={class:"level-picker"},Ae=N({__name:"CompendiumTech",setup(m){const f={RedStarScanner:D.RedStarScanner,ShipmentRelay:D.ShipmentRelay},i={Transport:O.Transport,Miner:O.Miner,Battleship:O.Battleship},{MaxModuleLevel:h}=re,p=Object.fromEntries([...Object.entries(f).map(([e,t])=>[e,t.Cost.length]),...Object.entries(i).map(([e,t])=>[e,t.BuildCost.length]),...Object.keys(C).map(e=>[e,h]),["AllianceLevel",ue.XPRequired.length]]),c=Object.fromEntries([...Object.keys(f).map(e=>[e,0]),...Object.keys(i).map(e=>[e,0]),...Object.entries(C).map(([e,t])=>[e,V(t)]),["AllianceLevel",0]]),r=F((...e)=>d.setTechLevel(...e),500),{t:l}=G(),j=l("HS_COMPENDIUM"),_=L(!1),s=L(null),g=L({}),a=K({size:X.SMALL,title:l("TECHNOLOGIES"),data:{value:{},maxLevel:0,minLevel:0,lastAgoUpdate:0,get key(){return this.value.Name}}}),R=setInterval(T,5e3);Y(()=>{d.getUser()&&(s.value=d.getTechLevels())}),Z(()=>{clearTimeout(R)}),J(s,e=>{e&&(g.value=de(e,{map:([t,o])=>[se(t),o.level]}))},{deep:!0}),d.on("sync",e=>s.value=e),d.on("connected",()=>s.value=d.getTechLevels()),d.on("disconnected",()=>{s.value=void 0,g.value=void 0});function U(e){s.value&&(a.data.value=e,a.data.maxLevel=p[e.Name],a.data.minLevel=c[e.Name],_.value=!0,T())}function P(e){var t;return!((t=I(e))!=null&&t.level)}function w(e){const t=x(a.data.key);return s.value[t]||(s.value[t]={level:0}),a.data.minLevel!=0&&e==a.data.minLevel&&s.value[t].level!=0&&(e=0),s.value[t].level!=e&&(s.value[t].level=e,r(t,e),T()),e}function V(e){let t=1;for(const[,o]of Object.entries(e))Array.isArray(o)&&o.length>t&&(t=o.length);return h-t+1}function I(e){var t;return((t=s.value)==null?void 0:t[x(e)])||null}function H(){var t;const e=a.data.value;if(e.Icon)return y(b,{name:e.Icon,dir:e.specialIcon?"icons":"game/Modules"});if(e.Model)return y(b,{name:e.Model[((t=I(e.Name))==null?void 0:t.level)-1||5],dir:"game/Ships"});if(e.PrefabModel)return y(b,{name:e.PrefabModel,dir:"game/SpaceBuildings"})}function T(){var e;if(_.value){const t=(e=I(a.data.key))==null?void 0:e.ts;t&&(a.data.lastAgoUpdate=(new Date-t)/1e3)}}function q(e){const t=[],o=Math.trunc(e/86400),u=Math.trunc(e%86400/3600),B=Math.trunc(e%3600/60),k=Math.trunc(e%60);return o!=0&&t.push(`${o}${l("TID_DAY_ABBREVIATION")}`),u!=0&&t.push(`${u}${l("TID_HOUR_ABBREVIATION")}`),B!=0&&t.push(`${B}${l("TID_MINUTE_ABBREVIATION")}`),k!=0&&t.push(`${k}${l("TID_SECOND_ABBREVIATION")}`),t.slice(0,2).join(" ")}return(e,t)=>{const o=Q("t");return $(),W(ce,null,{default:M(()=>[v(S(ee),null,{default:M(()=>[n("title",null,A(S(j)),1)]),_:1}),n("div",null,[n("div",Ie,[v(ie,{"on-click":U,"is-muted":P,"level-map":g.value},null,8,["level-map"])]),v(ne,ae({open:_.value,"onUpdate:open":t[0]||(t[0]=u=>_.value=u)},a),{body:M(()=>{var u;return[n("div",ge,[n("div",Te,[n("div",null,[n("h2",null,A(e.$t(a.data.value.TID)),1),n("p",null,A(S(l)("TID_SOCIAL_TIMESTAMP",[q(a.data.lastAgoUpdate)])),1),Le]),v(H)]),te(n("span",null,null,512),[[o,"CURRENT_LVL"]]),n("div",Me,[v(he,{value:((u=I(a.data.key))==null?void 0:u.level)||0,min:a.data.minLevel,max:a.data.maxLevel,"onUpdate:value":w},null,8,["value","min","max"])])])]}),_:1},16,["open"])])]),_:1})}}}),je=E(Ae,[["__scopeId","data-v-739e2af6"]]);export{je as default};
