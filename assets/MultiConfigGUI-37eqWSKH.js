var R=Object.defineProperty;var U=(n,s,t)=>s in n?R(n,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[s]=t;var E=(n,s,t)=>(U(n,typeof s!="symbol"?s+"":s,t),t);import{j as $,aG as D,aM as k,d as G,s as j,g as B,i as J,a as P,r as K,o as w,b as N,f as u,w as b,A as z,t as L,aN as V,F as H,B as Y,J as Z,K as q,_ as Q}from"./index-CFubWPy9.js";const M={crush:(n,s=50)=>{const t="",l=(e,a)=>{let h=a.length,d="";const v=i=>encodeURI(encodeURIComponent(i)).replace(/%../g,"i").length,F=i=>{let c=i.charCodeAt(0),f=i.charCodeAt(i.length-1);return c>=56320&&c<=57343||f>=55296&&f<=56319};let m={};for(let i=2;i<s;i++)for(let c=0;c<e.length-i;++c){let f=e.substr(c,i);if(m[f]||F(f))continue;let O=1;for(let _=e.indexOf(f,c+i);_>=0;++O)_=e.indexOf(f,_+i);O>1&&(m[f]=O)}for(;;){for(;h--&&e.includes(a[h]););if(h<0)break;let i=a[h],c,f=0,O=v(i);for(let I in m){let S=m[I],C=(S-1)*v(I)-(S+1)*O;d.length||(C-=v(t)),C<=0?delete m[I]:C>f&&(c=I,f=C)}if(!c)break;e=e.split(c).join(i)+i+c,d=i+d;let _={};for(let I in m){let S=I.split(c).join(i),C=0;for(let y=e.indexOf(S);y>=0;++C)y=e.indexOf(S,y+S.length);C>1&&(_[S]=C)}m=_}return{a:e,b:d}};let o=[];const r="-_.!~*'()";for(let e=127;--e;)(e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122||r.includes(String.fromCharCode(e)))&&o.push(String.fromCharCode(e));for(let e=32;e<255;++e){let a=String.fromCharCode(e);a!="\\"&&!o.includes(a)&&o.unshift(a)}n=n.replace(new RegExp(t,"g"),""),n=x(n);const g=l(n,o);let p=g.a;return g.b.length&&(p+=t+g.b),p+="_",p},uncrush:n=>{n=n.substring(0,n.length-1);const s=n.split("");let t=s[0];if(s.length>1){let l=s[1];for(let o of l){let r=t.split(o);t=r.join(r.pop())}}return x(t,0)}},x=(n,s=1)=>{const t=[['"',"'"],["':","!"],[",'","~"],["}",")","\\","\\"],["{","(","\\","\\"]],l=(o,r)=>{let g=new RegExp(`${(r[2]?r[2]:"")+r[0]}|${(r[3]?r[3]:"")+r[1]}`,"g");return o.replace(g,p=>p===r[0]?r[1]:r[0])};if(s)for(let o=0;o<t.length;++o)n=l(n,t[o]);else for(let o=t.length;o--;)n=l(n,t[o]);return n},A="default entry",T="en";class W{constructor(s,t){E(this,"store");E(this,"TIDs",{});this.localStoreKey=s,this.zeroConfig=t,this.store=$({configs:[],selected:0}),this.load()}get selectedConfig(){return this.store.configs[this.store.selected].value}load(){const s=JSON.parse(localStorage.getItem(this.localStoreKey)||"{}");if(s){if(s.configs){Object.assign(this.store,s);return}localStorage.removeItem(this.localStoreKey)}this.add(this.zeroConfig)}save(){localStorage.setItem(this.localStoreKey,JSON.stringify(this.store))}removeSelected(){if(this.store.configs.splice(this.store.selected,1),this.store.configs.length==0){this.add(this.zeroConfig);return}this.store.selected=this.store.configs.length-1}add(s,{temporary:t}={temporary:!1}){let l=0,o;do o=l?`${A} #${l}`:A,l++;while(this.store.configs.length&&this.store.configs.some(r=>r.name==o));this.store.configs=[...this.store.configs,{name:o,value:s}],this.store.selected=this.store.configs.length-1,t||this.save()}async parseString(s){const t=[];D.global.availableLocales.includes(T)||await k(T);for(const[l,o]of Object.entries(this.TIDs)){const r=D.global.t(o,T),g=new RegExp(`${r}\\s+?(\\d+)\\s?`,"mi"),[,p]=s.match(g)||[void 0,"0"];t.push([l,parseInt(p)])}return Object.fromEntries(t.filter(([,l])=>l))}static stringifyUrl(s){const t=JSON.stringify(s);return M.crush(t)}static parseUrl(s){return JSON.parse(M.uncrush(s))}}const X={class:"container"},ee={class:"config-category"},te={class:"flex-end"},se={class:"select"},oe={class:"name"},ne=["value"],le={class:"input"},re={class:"name"},ie=["placeholder"],ae={class:"flex-end margin-bottom"},ce=G({__name:"MultiConfigGUI",props:{instance:{},onCreateNew:{type:Function},dataToString:{}},setup(n){const s=j(),{t}=B(),l=n,o=J({text:t("COPY"),color:"yellow"}),r=P(()=>`${location.origin}${location.pathname}`);function g(){const e=W.stringifyUrl(l.dataToString??l.instance.selectedConfig);navigator.clipboard.writeText(`${r.value}?d=${e}`).then(()=>{o.value={text:t("COPIED"),color:"green"},setTimeout(()=>o.value={text:t("COPY"),color:"yellow"},2e3)}).catch(a=>{o.value={text:t("Error"),color:"red"},alert(a.message),console.error(a)})}async function p(){const{name:e}=l.instance.store.configs[l.instance.store.selected];await s.dispatch(q.OPEN_CONFIRM,t("REMOVE_CONFIG",[e])).then(()=>{l.instance.removeSelected()}).catch(()=>{})}return(e,a)=>{const h=K("t");return w(),N("div",X,[u("div",ee,[b(u("p",null,null,512),[[h,"CONFIG"]]),u("div",te,[u("button",{class:z(`button ${o.value.color}`),onClick:g},L(o.value.text),3),b(u("button",{class:"button green",onClick:a[0]||(a[0]=(...d)=>e.onCreateNew&&e.onCreateNew(...d))},null,512),[[h,"CREATE"]])])]),u("div",se,[b(u("p",oe,null,512),[[h,"LIST"]]),b(u("select",{"onUpdate:modelValue":a[1]||(a[1]=d=>e.instance.store.selected=d)},[(w(!0),N(H,null,Y(e.instance.store.configs,(d,v)=>(w(),N("option",{key:v,value:v},L(d.name),9,ne))),128))],512),[[V,e.instance.store.selected]])]),u("div",le,[b(u("p",re,null,512),[[h,"TID_CHANGE_NAME_TITLE"]]),b(u("input",{"onUpdate:modelValue":a[2]||(a[2]=d=>e.instance.store.configs[e.instance.store.selected].name=d),placeholder:e.$t("TID_CORP_NAME_LABEL")},null,8,ie),[[Z,e.instance.store.configs[e.instance.store.selected].name]])]),u("div",ae,[b(u("button",{class:"button red",onClick:p},null,512),[[h,"TID_SOCIAL_DELETE_MESSAGE"]])])])}}}),fe=Q(ce,[["__scopeId","data-v-fe966709"]]);export{W as M,fe as a};
