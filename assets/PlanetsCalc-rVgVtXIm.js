import{d as ae,g as le,l as V,m as se,S as oe,a as ne,A as O,B as H,r as re,o as m,b as _,f as o,e as j,w as q,u as S,h as F,F as P,D as R,t as I,v as ie,M as ce,C as X,p as ue,i as de,aI as pe,_ as me}from"./index-U3-o_TFl.js";import{l as Z,Y as x}from"./planet_levels-OgGYPt_4.js";import{o as M,p as _e,V as fe}from"./Data-vhKwxOFC.js";import{s as Ce}from"./spacebuildings-NmTc9Pj4.js";import{g as Se}from"./globals-zpsYnYkF.js";import{C as he}from"./Calculator-r2ty-EV6.js";import{g as ve}from"./getFilterByType-aSftiFBn.js";import"./sec2str-Kbc2cQQ2.js";import"./TheConfirm-bXwIf6n-.js";import"./byTypes-1BYQ2hUk.js";function ge(h){return h[0].map((B,L)=>h.map(D=>D[L]))}const N=h=>(ue("data-v-d9aa6448"),h=h(),de(),h),Te={class:"wrap"},Le={class:"container"},ye={class:"switch"},Ae={class:"name"},Pe=N(()=>o("p",null,null,-1)),Re=["checked"],Ie=N(()=>o("label",{for:"compact-mode",class:"label"},null,-1)),De=N(()=>o("th",null,null,-1)),be=["onChange"],Ee=["selected","disabled"],Me=["onClick"],Ne=N(()=>o("img",{src:pe,class:"open-info",alt:"info icon"},null,-1)),Ue=[Ne],ke={class:"modal-module"},Ve={class:"chars"},Oe={class:"output"},He=ae({__name:"PlanetsCalc",setup(h){const{SP2ShipmentsBoostPct:B}=Se,L={CreditStorage:"CreditStorageModifier",FuelStorage:"FuelStorageModifier",CreditsPerHour:"CreditIncomeModifier",FuelPerHour:"FuelIncomeModifier",ShipmentsCRValuePerDay:"CreditShipmentModifier"},D={TotalShipmentCRPerDay:"ShipmentsCRValuePerDay",Cost:"Cost",ConstructionTime:"TimeToUpgrade"},w=["XPAward","Cost","TimeToUpgrade","TimeToUpgradeParallel","RSLevelReq"],$=["CrystalsWeight","Name"],K=Object.keys(Z).filter(t=>![...w,...$].includes(t)),Y=Object.values(x.NumMoons).reduce((t,a,u)=>(a&&(Array.isArray(a)?a.forEach((e,l)=>t[x.PlanetTypes[u][l]]=e):t[x.PlanetTypes[u]]=a),t),{}),{t:J}=le(),W=V([]),g=V({actually:{},plan:{}}),U=V(!1),v=se({size:oe.SMALL,title:"name",data:{planet:{},get key(){return this.planet.Name}}}),T=ne(()=>Object.values(W.value));let c;O.subscribe(t=>{t.type==H.SWITCH_PLANETS_CALC_SP2&&c&&(z(c),c.forceReCalc()),t.type==H.SET_CALC_DAY_CREDIT_LIMIT&&c.forceReCalc()});function z(t){c=t,W.value=t.provideGetterElements(te)}function Q(t){v.title=J(t.TID),v.data.planet=t,U.value=!0}function G(t,a){return c.outputClasses(t,v.data.key,a)}function ee(t,a){let u=0;const e={};for(const l of K)a.total.intermediate[l]={actually:0,plan:0,sum:0};return function(l,r){var n,C;const d=O.state.userSettings.calcDayCreditLimit/24;let s=0;for(const i of K)a.total.intermediate[i].actually+=((n=a.actually[l])==null?void 0:n[i])||0,a.total.intermediate[i].plan+=((C=a.plan[l])==null?void 0:C[i])||0,a.total.intermediate[i].sum=a.total.intermediate[i].actually+a.total.intermediate[i].plan;if(t[l].RSLevelReq){const i=t[l].RSLevelReq[r.plan[l]]||0;u=a.total.result.RSLevelReq=u<i?i:u}if(t[l].TimeToUpgrade){const i=t[l],y=r.actually[l],b=r.plan[l],p=[];for(let f=0;f<b-y;f++){const A=y+f,k=i.TimeToUpgrade[A]/3600;for(let E=0;E<k;E++)p.push(i.Cost[A]/(i.TimeToUpgrade[A]/3600))}p.length?e[l]=p:delete e[l],Object.keys(e).length&&(ge(Object.values(e)).forEach(f=>{const A=f.reduce((k,E)=>k+E||0,0);s+=Math.ceil(A/d)}),a.total.result.TimeToUpgradeParallel=s*3600)}}}function te(...[t,a,u]){let e=0;const l=M(Z,{filter:([,s])=>Array.isArray(s)}),r=M(_e,{...ve("planets.yellowstar"),map:([s,n])=>(u[s]=M(l,{map:([C,i])=>{const y=n.MaxUpgradeLevel,b=O.state.userSettings.planetsCalcSp2&&C=="ShipmentsCRValuePerDay"?B/100:0;let p=i.map(f=>f*(C in L?n[L[C]]/100:1+b));return C=="ShipmentsCRValuePerDay"&&n.Name in Y&&(p=i.map(f=>f*(n[L.ShipmentsCRValuePerDay]/100+b)*(Y[n.Name]+1))),p.length<y&&p.push(...Array.from({length:y-p.length},()=>p[p.length-1])),[C,p]}}),t[s]=n.TID,[s,n])}),d=M(Ce.TradingStation,{map:([s,n])=>(Array.isArray(n)&&n.length>e&&(e=n.length),[s in D?D[s]:s,n])});d.MaxUpgradeLevel=e;for(let s=0;d.MaxOnOwnSolarSystem>s;s++){const n={...d,Name:`${d.Name}_${s}`};r[n.Name]=n,u[n.Name]=a(n,e)}return r}return(t,a)=>{const u=re("t");return m(),_("div",Te,[o("div",Le,[j(he,{input:g.value,"onUpdate:input":a[0]||(a[0]=e=>g.value=e),"stack-chars":w,"calc-total":ee,"local-storage-key":"planetsCalc","title-key":"PLANETS_CALC",onSetup:z},null,8,["input"]),o("div",ye,[o("div",null,[q(o("p",Ae,null,512),[[u,"TID_STARTER_PACK_2"]]),Pe]),o("input",{id:"compact-mode",class:"checkbox",type:"checkbox",checked:t.$store.state.userSettings.planetsCalcSp2,onChange:a[1]||(a[1]=e=>t.$store.commit(S(H).SWITCH_PLANETS_CALC_SP2))},null,40,Re),Ie]),j(fe,{data:{TID:"INPUT_VALUES",Name:"Input",TID2:T.value.map(e=>e.TID)},"table-opts":{lvlColKey:"â„–",mergeCells:!1}},{"table-head":F(()=>[q(o("th",null,null,512),[[u,"CURRENT_LVL"]]),q(o("th",null,null,512),[[u,"PLAN_LVL"]]),De]),"table-body":F(({row:e})=>[(m(!0),_(P,null,R(g.value,(l,r)=>(m(),_("td",{key:r},[o("select",{class:"select",onChange:d=>S(c).onChangeLvl(r,T.value[e].Name,d.target.value)},[(m(!0),_(P,null,R(T.value[e].MaxUpgradeLevel+1,(d,s)=>(m(),_("option",{key:r+d,selected:S(c).isSelected(r,T.value[e].Name,s),disabled:S(c).isDisabled(r,T.value[e].Name,s)},I(s),9,Ee))),128))],40,be)]))),128)),o("td",null,[o("div",{onClick:()=>Q(T.value[e])},Ue,8,Me)])]),_:1},8,["data"])]),j(ce,ie({open:U.value,"onUpdate:open":a[2]||(a[2]=e=>U.value=e)},v),{body:F(()=>[o("div",ke,[o("ul",Ve,[o("li",Oe,[o("b",null,I(t.$t("TID_PLANET_LEVEL_DESCR")),1),o("div",null,[(m(!0),_(P,null,R(g.value,(e,l)=>{var r;return m(),_("span",{key:l,class:X(G(l,null))},I((r=g.value[l])==null?void 0:r[v.data.key]),3)}),128))])]),(m(!0),_(P,null,R(Object.keys(S(c).output.plan[v.data.key]||{}).filter(e=>!$.includes(e)),e=>(m(),_("li",{key:e,class:"calc.output"},[o("b",null,I(S(c).format.key(e)),1),o("div",null,[(m(!0),_(P,null,R(g.value,(l,r)=>{var d,s;return m(),_("span",{key:r,class:X(G(r,e))},I(S(c).format.value(e,Math.trunc((s=(d=S(c).output[r])==null?void 0:d[v.data.key])==null?void 0:s[e])||void 0)),3)}),128))])]))),128))])])]),_:1},16,["open"])])}}}),ze=me(He,[["__scopeId","data-v-d9aa6448"]]);export{ze as default};
