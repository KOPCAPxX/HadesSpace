import{d as te,s as le,aI as oe,g as ne,i as _,j as ie,y as ae,D as de,z as ue,x as pe,r as re,o as p,b as r,e as d,h as C,f as o,t as c,u as n,H as ce,w as v,F as m,B as S,S as M,M as I,A as U,I as b,aN as Y,E as $,p as ve,q as me,_ as fe}from"./index-CFubWPy9.js";import{g as _e,m as B}from"./ModulePage.vue_vue_type_script_setup_true_lang-gyU0qjyt.js";import{M as A,a as Ce}from"./MultiConfigGUI-37eqWSKH.js";import{c as he}from"./compendiumTechList-791IVu9v.js";import{b as ge}from"./byTypes-1BYQ2hUk.js";import{g as Se}from"./globals-zpsYnYkF.js";import{s as H}from"./capital_ships-ioQeNDqF.js";import{T as q}from"./TechList-uFHsnQpc.js";import{N as Me}from"./NumberPicker-R6zG5xZC.js";import{o as Ie}from"./Data-lTdtglJC.js";import"./Page-HzRMlrQv.js";import"./spacebuildings-NmTc9Pj4.js";import"./sec2str-_W7WIMRA.js";const ye=y=>(ve("data-v-ab0f571f"),y=y(),me(),y),Te={class:"container"},Le={class:"topic"},De={class:"buttons"},Ee={class:"ship-list"},be=["onClick"],ke={class:"icon"},Oe={class:"body"},Ne={class:"modules"},Ue={key:0,class:"level"},$e={class:"create-ship-list"},Be=["onClick"],Ae=["onUpdate:modelValue"],He=["value"],Pe={class:"edit-ship"},we={class:"modal-module"},ze={class:"title"},Re={class:"level-picker"},Ge={class:"module-levels"},Ve={class:"select"},je={class:"name"},Ye={value:{provider:null}},qe={value:{provider:"Edit"}},xe={disabled:""},Fe=["value"],Ke={disabled:""},We=ye(()=>o("option",{value:{provider:"HSCompendium",index:0}}," 0 ",-1)),Ze="shipBuild",Je="modulesCalc",Qe=te({__name:"ShipBuild",setup(y){const T={levels:{Transport:1,Miner:1,Battleship:1},ships:[]},h={Battleship:H.Battleship,Transport:H.Transport,Miner:H.Miner},{MaxModuleLevel:x}=Se,F=Ie(B,{map:([l,e])=>[l,_e(e)]}),P=le(),w=oe(),{t:K}=ne(),{data:W,levelMap:z}=he(),t=new A(Ze,T),R=new A(Je,{}),G=K("SHIP_BUILD"),V=Object.keys(h),L=_(!1),k=_(!1),D=_(!1),O=_(!1),N=_(!1),g=_(P.state.userSettings.shipBuildSync),i=ie({data:{hideModulesTypes:[],removeShip:()=>{},ship:{slots:[]},module:{Name:"",Icon:"",TID:""},updateModule:()=>{}}});if(j(),w.currentRoute.value.query.d){const e={...A.parseUrl(w.currentRoute.value.query.d)};t.add(e,{temporary:!0})}ae(async()=>{await de()}),ue(z,l=>{g.value.provider=="HSCompendium"&&(t.selectedConfig.levels={...l})});function Z(l){t.selectedConfig.ships.push({meta:{type:l},slots:[]}),t.selectedConfig.ships.sort((e,u)=>V.indexOf(e.meta.type)-V.indexOf(u.meta.type)),t.save(),L.value=!1}function J(l){const e=t.selectedConfig.ships[l],{levels:u}=t.selectedConfig,s=[],{NewModuleSlots:a}=h[e.meta.type];typeof a=="string"?s.push(...Array(u[e.meta.type]).fill(a)):Array.isArray(a)&&s.push(...a.slice(0,u[e.meta.type]).flat()),e.slots.length||(e.slots=s),i.data.ship=e,i.data.hideModulesTypes=ge.artifact.filter(E=>!s.includes(E)),i.data.removeShip=()=>{t.selectedConfig.ships.splice(l,1),t.save(),D.value=!1},t.save(),D.value=!0}function Q(l){return i.data.ship.slots.includes(l)}function X({SlotType:l,Name:e}){const u=i.data.ship.slots.indexOf(e);if(u!=-1)i.data.ship.slots[u]=l;else{const s=i.data.ship.slots.indexOf(l);s!=-1&&(i.data.ship.slots[s]=e)}t.save()}function ee(l){i.data.module=l,i.data.updateModule=e=>{t.selectedConfig.levels[l.Name]=e,t.save()},O.value=!0}function j(){const{provider:l,index:e}=g.value;l=="ModulesCalc"&&(t.selectedConfig.levels={Transport:t.selectedConfig.levels.Transport,Miner:t.selectedConfig.levels.Miner,Battleship:t.selectedConfig.levels.Battleship,...R.store.configs[e].value.actually}),l=="HSCompendium"&&(t.selectedConfig.levels={...z}),l==null&&Object.keys(t.selectedConfig.levels).length!=Object.keys(T.levels).length&&(t.selectedConfig.levels={...T.levels}),P.commit(pe.SET_SHIP_BUILD_SYNC,g.value),t.save()}return(l,e)=>{const u=re("t");return p(),r("div",Te,[d(n(ce),null,{default:C(()=>[o("title",null,c(n(G)),1)]),_:1}),o("h1",Le,c(n(G)),1),o("div",De,[o("button",{class:"settings-btn",onClick:e[0]||(e[0]=s=>N.value=!0)}),v(o("button",{class:"button accent",onClick:e[1]||(e[1]=s=>L.value=!0)},null,512),[[u,"TID_PC_NEW_SHIP"]]),v(o("button",{class:"button accent",onClick:e[2]||(e[2]=s=>k.value=!0)},null,512),[[u,"TID_MODULE_LEVEL_HINT_TITLE"]])]),o("ul",Ee,[(p(!0),r(m,null,S(n(t).selectedConfig.ships,({meta:{type:s},slots:a},E)=>(p(),r("li",{key:`${s}${E}`,class:"ship",onClick:f=>J(E)},[o("div",ke,[d(b,{dir:"game/Ships",name:h[s].Model[n(t).selectedConfig.levels[s]-1]},null,8,["name"])]),o("div",Oe,[v(o("p",null,null,512),[[u,h[s].TID]]),o("ul",Ne,[(p(!0),r(m,null,S(a,(f,se)=>(p(),r("li",{key:`${f}${se}`},[f in n(B)?(p(),r(m,{key:0},[d(b,{dir:"game/Modules",name:n(B)[f].Icon},null,8,["name"]),n(t).selectedConfig.levels[f]?(p(),r("span",Ue,c(n(t).selectedConfig.levels[f]),1)):$("",!0)],64)):$("",!0)]))),128))])])],8,be))),128))]),d(I,{open:L.value,"onUpdate:open":e[4]||(e[4]=s=>L.value=s),title:l.$t("TID_PC_NEW_SHIP"),size:n(M).SMALL},{body:C(()=>[o("ul",$e,[(p(),r(m,null,S(h,s=>o("li",{key:s.Name,class:"ship"},[o("div",{class:"icon",onClick:a=>Z(s.Name)},[d(b,{dir:"game/Ships",name:s.Model[n(t).selectedConfig.levels[s.Name]-1]},null,8,["name"])],8,Be),o("div",{class:U(["select",{disable:l.$store.state.userSettings.shipBuildSync.provider=="HSCompendium"}])},[v(o("select",{"onUpdate:modelValue":a=>n(t).selectedConfig.levels[s.Name]=a,onChange:e[3]||(e[3]=(...a)=>n(t).save&&n(t).save(...a))},[(p(!0),r(m,null,S(s.BuildCost.length,a=>(p(),r("option",{key:a,value:a},c(a),9,He))),128))],40,Ae),[[Y,n(t).selectedConfig.levels[s.Name]]])],2)])),64))])]),_:1},8,["open","title","size"]),d(I,{open:D.value,"onUpdate:open":e[6]||(e[6]=s=>D.value=s),title:l.$t("TID_CORP_DIALOG_EDIT"),size:n(M).LARGE},{body:C(()=>[o("div",Pe,[o("div",{class:U(["tech-list",i.data.hideModulesTypes])},[d(q,{"is-muted":Q,"on-click":X})],2),v(o("button",{class:"button red",onClick:e[5]||(e[5]=(...s)=>i.data.removeShip&&i.data.removeShip(...s))},null,512),[[u,"TID_DISBAND_SHIP_BUTTON"]])])]),_:1},8,["open","title","size"]),d(I,{open:O.value,"onUpdate:open":e[7]||(e[7]=s=>O.value=s),title:l.$t("TID_CORP_DIALOG_EDIT"),size:n(M).SMALL},{body:C(()=>[o("div",we,[o("div",ze,[o("div",null,[o("h2",null,c(l.$t(i.data.module.TID)),1)]),d(b,{name:i.data.module.Icon,dir:"game/Modules"},null,8,["name"])]),o("div",Re,[d(Me,{value:n(t).selectedConfig.levels[i.data.module.Name]||0,min:n(F)[i.data.module.Name],max:n(x),"onUpdate:value":i.data.updateModule},null,8,["value","min","max","onUpdate:value"])])])]),_:1},8,["open","title","size"]),d(I,{open:k.value,"onUpdate:open":e[9]||(e[9]=s=>k.value=s),title:l.$t("TID_MODULE_LEVEL_HINT_TITLE"),size:n(M).LARGE},{body:C(()=>[o("div",Ge,[o("div",Ve,[v(o("p",je,null,512),[[u,"SYNC"]]),v(o("select",{"onUpdate:modelValue":e[8]||(e[8]=s=>g.value=s),onChange:j},[o("option",Ye,c(l.$t("TID_PLAYER_INFO_CORP_NONE")),1),o("option",qe,c(l.$t("TID_CORP_DIALOG_EDIT")),1),o("option",xe,"--- "+c(l.$t("MODULES_CALC"))+" ---",1),(p(!0),r(m,null,S(n(R).store.configs,(s,a)=>(p(),r("option",{key:a,value:{provider:"ModulesCalc",index:a}},c(s.name),9,Fe))),128)),n(W)?(p(),r(m,{key:0},[o("option",Ke,"--- "+c(l.$t("HS_COMPENDIUM"))+" ---",1),We],64)):$("",!0)],544),[[Y,g.value]])]),o("div",{class:U(["tech-list",{disable:l.$store.state.userSettings.shipBuildSync.provider!="Edit"}])},[d(q,{"level-map":n(t).selectedConfig.levels,"on-click":ee},null,8,["level-map"])],2)])]),_:1},8,["open","title","size"]),d(I,{open:N.value,"onUpdate:open":[e[10]||(e[10]=s=>N.value=s),e[11]||(e[11]=()=>n(t).save())],title:l.$t("TID_SETTINGS_DLG_TITLE"),size:n(M).MEDIUM},{body:C(()=>[d(Ce,{"on-create-new":()=>n(t).add(T),instance:n(t)},null,8,["on-create-new","instance"])]),_:1},8,["open","title","size"])])}}}),cs=fe(Qe,[["__scopeId","data-v-ab0f571f"]]);export{cs as default};
