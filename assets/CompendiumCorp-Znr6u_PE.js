import{d as K,g as Q,l as f,A as T,m as w,k as _,B as x,n as W,s as F,r as ee,o as r,b as c,e as u,h as E,f as a,t as h,u as p,H as te,C as A,w as z,F as y,D as S,S as $,M as H,y as C,I as G,x as se,_ as ne}from"./index-U3-o_TFl.js";import{C as ae,T as j,g as oe,m as ie}from"./CompendiumTechList-5Y6sYXDz.js";import{s as D}from"./capital_ships-IMpdbOfS.js";import{s as le}from"./spacebuildings-NmTc9Pj4.js";import{m as R}from"./ModulePage.vue_vue_type_script_setup_true_lang-UZDz0qsU.js";import{o as re}from"./Data-vhKwxOFC.js";import"./TheConfirm-bXwIf6n-.js";import"./byTypes-1BYQ2hUk.js";import"./Page-JIGQiI0r.js";import"./globals-zpsYnYkF.js";import"./sec2str-Kbc2cQQ2.js";const ce={class:"container"},ue={class:"select"},de=["value","selected"],me=["onClick"],pe={class:"meta"},fe={class:"avatar"},ve=["src","alt"],_e={class:"sort-tech"},he=["k"],Ce={class:"modal-filter-tech"},ge={class:"sections-group other"},Ie={class:"type",name:"user-info"},Te=["onClick"],Ee=5,J=50,ye=K({__name:"CompendiumCorp",setup(Se){const{t:V}=Q(),Y=V("HS_COMPENDIUM"),{hourCycles:k}=new Intl.Locale(navigator.language),X=k?["h23","h24"].some(t=>k.includes(t)):!0,l={LocalTime:{icon:{name:"time",dir:"icons/compendium"},formatter:({localTime:t,localTime24:s})=>X?s:t},AfkFor:{icon:{name:"afk",dir:"icons/compendium"},formatter:({afkFor:t})=>t},CargoCap:{icon:{name:"cargo",dir:"icons/compendium"},formatter:({tech:t})=>{const[s]=t[C("Transport")]||[],[o]=t[C("TransportCapacity")]||[];return s&&o?D.Transport.JobCapacity[s]+R.TransportCapacity.ExtraTradeSlots[o]:0}}},v=f(!1),M=f(!1),L=f(!1),g=f(T.state.userSettings.compendiumCorpLastRoleId),i=w([]),O=f({}),d=f([]),I=w({title:"",lvlMap:void 0});let m=[];d.value=Array.from({length:10},t=>({userId:t,name:"",avatarUrl:""})),_.on("connected",()=>B()),_.on("disconnected",()=>{m=[],d.value=Array.from({length:10},t=>({userId:t,name:"",avatarUrl:""})),g.value="",i.splice(0),T.commit(x.SET_COMPENDIUM_CORP_LAST_ROLE_ID)}),W(()=>{_.getUser()&&B()}),F(g,async t=>{v.value=!0,T.commit(x.SET_COMPENDIUM_CORP_LAST_ROLE_ID,t),m=await _.corpdata(t).then(s=>s.members),d.value=m,v.value=!1,P(i)}),F(()=>i,P,{deep:!0});async function B(){v.value=!0;const t=await _.corpdata(T.state.userSettings.compendiumCorpLastRoleId);O.value=t,m=t.members,d.value=t.members.slice(0,J),v.value=!1}async function N(t){b(t.Name)?i.splice(i.indexOf(t.Name),1):i.push(t.Name)}function b(t){return i.includes(t)}function Z(t){m.length&&(I.title=t.name,I.lvlMap=re(t.tech,{map:([s,o])=>[se(s),o[0]]}),L.value=!0)}function P(t){d.value=m.sort((s,o)=>{var e,n;return t.length&&!(t[0]in l)?(((e=o.tech[C(t[0])])==null?void 0:e[0])||0)-(((n=s.tech[C(t[0])])==null?void 0:n[0])||0):t[0]=="CargoCap"?l.CargoCap.formatter(o)-l.CargoCap.formatter(s):0}).slice(0,J)}function q(t){if(!i.length)return{};const s={},o=Object.fromEntries(i.map(e=>{var n;return e in l?[e,l[e].formatter(t)]:[e,(n=t.tech[C(e)])==null?void 0:n[0]]}).slice(Ee*-1));for(const e in o){const n=s[e]={icon:{dir:"",name:""},level:o[e]};e in R?(n.icon.dir="game/Modules",n.icon.name=R[e].Icon):e in D?(n.icon.dir="game/Ships",n.icon.name=D[e].Model[5]):e in l?n.icon=l[e].icon:(n.icon.dir="game/SpaceBuildings",n.icon.name=le[e].PrefabModel)}return s}return(t,s)=>{const o=ee("t");return r(),c("div",null,[u(p(te),null,{default:E(()=>[a("title",null,h(p(Y)),1)]),_:1}),u(ae,null,{default:E(()=>[a("div",ce,[a("div",{class:A(["filter",{disable:d.value.length>p(m).length}])},[a("div",null,[z(a("button",{class:"btn-tech-filter",onClick:s[0]||(s[0]=e=>M.value=!0)},null,512),[[o,"FILTER"]])]),a("div",ue,[a("select",{onChange:s[1]||(s[1]=e=>g.value=e.target.value)},[(r(!0),c(y,null,S(O.value.roles,e=>(r(),c("option",{key:e.id,value:e.id,selected:g.value==e.id},h(e.name),9,de))),128))],32)])],2),a("ul",{class:A(["members-list",{"animated-fetch":v.value}])},[(r(!0),c(y,null,S(d.value,e=>(r(),c("li",{key:e.userId,class:"member",onClick:n=>Z(e)},[a("div",pe,[a("div",fe,[a("img",{src:p(oe)(e.userId,e.avatar),alt:`${e.name} avatar`,onError:s[2]||(s[2]=n=>n.target.src=p(ie))},null,40,ve)]),a("p",null,h(e.name),1)]),a("div",_e,[a("ul",null,[(r(!0),c(y,null,S(q(e),(n,U)=>(r(),c("li",{key:U},[a("div",null,[u(G,{name:n.icon.name,dir:n.icon.dir},null,8,["name","dir"]),a("span",{k:U,class:"level"},h(n.level),9,he)])]))),128))])])],8,me))),128))],2)])]),_:1}),u(H,{open:M.value,"onUpdate:open":s[4]||(s[4]=e=>M.value=e),title:"Code",size:p($).LARGE},{body:E(()=>[a("div",Ce,[a("button",{class:"button accent",onClick:s[3]||(s[3]=e=>i.splice(0))},h(t.$t("RESET_ALL")),1),a("div",ge,[a("section",Ie,[z(a("h3",null,null,512),[[o,"TID_OBJECT_ACTION_PLAYER_INFO"]]),a("ul",null,[(r(),c(y,null,S(l,({icon:e},n)=>a("li",{key:n,class:"item"},[a("div",{class:A({mute:b(n)}),onClick:()=>N({Name:n})},[u(G,{name:e.name,dir:e.dir},null,8,["name","dir"])],10,Te)])),64))])])]),u(j,{"on-click":N,"is-muted":b})])]),_:1},8,["open","size"]),u(H,{open:L.value,"onUpdate:open":s[5]||(s[5]=e=>L.value=e),title:I.title,size:p($).LARGE},{body:E(()=>[u(j,{"level-map":I.lvlMap},null,8,["level-map"])]),_:1},8,["open","title","size"])])}}}),Ue=ne(ye,[["__scopeId","data-v-9f622164"]]);export{Ue as default};
