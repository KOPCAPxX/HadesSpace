"use strict";(self["webpackChunkhades_space"]=self["webpackChunkhades_space"]||[]).push([[717],{64717:(e,t,n)=>{n.d(t,{Z:()=>Q});var l=n(66252),o=n(2262),s=n(3577),a=n(49963),i=n(16513),r=n(37928),c=n(77451),u=n(39563);const p={class:"wrap"},f={key:0,class:"container"},d={class:"buttons"},g=(0,l.aZ)({__name:"TheConfirm",emits:["setShow"],setup(e,{emit:t}){const n=(0,o.iH)(""),i=(0,o.iH)(!1);let r,c;function g(){h(c)}function y(e){return i.value=!0,n.value=e,new Promise(((e,t)=>{r=e,c=t}))}function h(e){e(),i.value=!1,r=()=>null,c=()=>null}return t("setShow",y),(e,t)=>{const y=(0,l.Q2)("t");return(0,l.wg)(),(0,l.j4)(u.Z,{title:"Confirm",open:i.value,"onUpdate:open":g},{default:(0,l.w5)((()=>[(0,l.Wm)(a.uT,null,{default:(0,l.w5)((()=>[(0,l._)("div",p,[i.value?((0,l.wg)(),(0,l.iD)("div",f,[(0,l.Uk)((0,s.zw)(n.value)+" ",1),(0,l._)("div",d,[(0,l.wy)((0,l._)("button",{onClick:t[0]||(t[0]=e=>h((0,o.SU)(c)))},null,512),[[y,"TID_CANCEL"]]),(0,l.wy)((0,l._)("button",{onClick:t[1]||(t[1]=e=>h((0,o.SU)(r)))},null,512),[[y,"TID_OK"]])])])):(0,l.kq)("",!0)])])),_:1})])),_:1},8,["open"])}}});var y=n(83744);const h=(0,y.Z)(g,[["__scopeId","data-v-7472dee3"]]),_=h;var m=n(83013),v=n(76216),w=n(16798),b=n(78642),C=n(52324);function S(e,t){const n=(0,o.qj)({actually:{},plan:{},total:{intermediate:{},result:{}}}),l={};for(const o of e)n.total.result[o]=0;const s=t(l,n);return{provideGetterElements:a,output:n,update:i};function a(e){return e(d,l)}function i(t,l){const o=(e,n)=>r(e,(([l],o,s)=>p(Object.fromEntries(s),l,t.actually[e],n))),a=(e,t)=>r(e,(([,e])=>Array.isArray(e)?e[t-1]:e));l?(c(n.plan,l,o(l,t.plan[l])),c(n.actually,l,a(l,t.actually[l]))):(u(t.plan,n.plan,o),u(t.actually,n.actually,a)),f(n.total);for(const[i,r]of Object.entries(n.plan))if(Object.keys(r).length){for(const t of e)n.total.result[t]+=r[t];s(i,t)}}function r(e,t){return(...n)=>{const[[o]]=n;if(k(l[e][o])){const n=(0,b.Z)(l[e][o],{map:(...e)=>[e[0][0],t(...e)]});return[o,n]}const s=t(...n);return[o,s]}}function c(e,t,n){l[t]&&(e[t]=(0,b.Z)(l[t],{map:n}))}function u(e,t,n){if(Object.keys(e).length)for(const[l,o]of Object.entries(e))o?c(t,l,n(l,o)):t[l]={};else for(const l of Object.keys(t))delete t[l]}function p(t,n,l,o){const s=t[n],a=l>0?s[l-1]:0;let i=s[o-1];if(!Array.isArray(s))return!l&&o?s:0;if(e.includes(n)){i=0;let e=l>0?l-1:0;while(e<=o-1)i+=s[e],e++}return i-a}function f(e){for(const t in e)if(t in e){if(k(e[t])){f(e[t]);continue}e[t]=0}}function d(t,n){const l=(0,C.K)(t);return o(l),l;function o(t){for(const l in t)if(l in t){const o=t[l],s="boolean"==typeof o[1]?o[0]:o;if(k(s)){const e=d(s,n);Object.keys(e).length?t[l]=e:delete t[l];continue}if((!Array.isArray(s)||s.length!=n)&&!e.includes(l)){delete t[l];continue}"boolean"==typeof o[1]&&(t[l]=s)}return t}}}function k(e){return"object"===typeof e&&!Array.isArray(e)&&null!==e}const E={crush:(e,t=50)=>{const n="",l=(e,l)=>{let o=l.length,s="";const a=e=>encodeURI(encodeURIComponent(e)).replace(/%../g,"i").length,i=e=>{let t=e.charCodeAt(0),n=e.charCodeAt(e.length-1);return t>=56320&&t<=57343||n>=55296&&n<=56319};let r={};for(let n=2;n<t;n++)for(let t=0;t<e.length-n;++t){let l=e.substr(t,n);if(r[l])continue;if(i(l))continue;let o=1;for(let s=e.indexOf(l,t+n);s>=0;++o)s=e.indexOf(l,s+n);o>1&&(r[l]=o)}while(1){for(;o--&&e.includes(l[o]););if(o<0)break;let t,i=l[o],c=0,u=a(i);for(let e in r){let l=r[e],o=(l-1)*a(e)-(l+1)*u;s.length||(o-=a(n)),o<=0?delete r[e]:o>c&&(t=e,c=o)}if(!t)break;e=e.split(t).join(i)+i+t,s=i+s;let p={};for(let n in r){let l=n.split(t).join(i),o=0;for(let t=e.indexOf(l);t>=0;++o)t=e.indexOf(l,t+l.length);o>1&&(p[l]=o)}r=p}return{a:e,b:s}};let o=[];const s="-_.!~*'()";for(let r=127;--r;)(r>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122||s.includes(String.fromCharCode(r)))&&o.push(String.fromCharCode(r));for(let r=32;r<255;++r){let e=String.fromCharCode(r);"\\"==e||o.includes(e)||o.unshift(e)}e=e.replace(new RegExp(n,"g"),""),e=O(e);const a=l(e,o);let i=a.a;return a.b.length&&(i+=n+a.b),i+="_",i},uncrush:e=>{e=e.substring(0,e.length-1);const t=e.split("");let n=t[0];if(t.length>1){let e=t[1];for(let t of e){let e=n.split(t);n=e.join(e.pop())}}return O(n,0)}},O=(e,t=1)=>{const n=[['"',"'"],["':","!"],[",'","~"],["}",")","\\","\\"],["{","(","\\","\\"]],l=(e,t)=>{let n=new RegExp(`${(t[2]?t[2]:"")+t[0]}|${(t[3]?t[3]:"")+t[1]}`,"g");return e.replace(n,(e=>e===t[0]?t[1]:t[0]))};if(t)for(let o=0;o<n.length;++o)e=l(e,n[o]);else for(let o=n.length;o--;)e=l(e,n[o]);return e},U="new entry",T="en";class A{localStoreKey;store;TIDs={};constructor(e){this.localStoreKey=e,this.store=(0,o.qj)({configs:[],selected:0}),this.load()}get selectedConfig(){return this.store.configs[this.store.selected].value}load(){const e=JSON.parse(localStorage.getItem(this.localStoreKey)||"{}");e.configs?Object.assign(this.store,e):Object.keys(e).length&&e.actually&&e.plan?this.add(e):this.add()}save(){localStorage.setItem(this.localStoreKey,JSON.stringify(this.store))}removeSelected(){this.store.configs.splice(this.store.selected,1),0!=this.store.configs.length?this.store.selected=this.store.configs.length-1:this.add()}add(e,{temporary:t}={temporary:!1}){const n=this.store;let l,o=0;do{l=o?`${U} #${o}`:U,o++}while(n.configs.length&&n.configs.some((e=>e.name==l)));n.configs=[...n.configs,{name:l,value:e||{actually:{},plan:{}}}],n.selected=n.configs.length-1,t||this.save()}async parseString(e){const t=[];i["default"].global.availableLocales.includes(T)||await(0,i.J)(T);for(const[n,l]of Object.entries(this.TIDs)){const o=i["default"].global.t(l,T),s=new RegExp(`${o}\\s+?(\\d+)\\s?`,"mi"),[,a]=e.match(s)||[void 0,"0"];t.push([n,parseInt(a)])}return Object.fromEntries(t.filter((([,e])=>e)))}stringifyUrl(){const e=JSON.stringify(this.selectedConfig.actually);return E.crush(e)}parseUrl(e){return JSON.parse(E.uncrush(e))}}const D=e=>((0,l.dD)("data-v-8ca73278"),e=e(),(0,l.Cn)(),e),I={class:"topic"},j={class:"total-table"},R={key:0,colspan:"3"},Z={class:"buttons"},x={class:"reset-buttons"},z={class:"settings-modal"},L={class:"config-category"},K={class:"flex-end"},$={class:"select"},N={class:"name"},H=["value"],M={class:"input"},F={class:"name"},G=["placeholder"],P={class:"flex-end margin-bottom"},Y={class:"input"},q={class:"name"},J=D((()=>(0,l._)("p",{class:"name"},"Example: Fortify 8 Bond 5",-1))),W={class:"flex-end margin-bottom"},V=(0,l.aZ)({__name:"Calculator",props:{stackChars:{},calcTotal:{},localStorageKey:{},titleKey:{},input:{}},emits:["update:input","setup"],setup(e,{emit:t}){const n=e,{t:p}=i["default"].global,f={key:e=>(0,v.Z)(e,r.Z.currentRoute.name),value:(e,t)=>(0,m.Z)(e,t,r.Z.currentRoute.value.name)},{provideGetterElements:d,output:g,update:y}=S(n.stackChars,n.calcTotal),h=new A(n.localStorageKey),b={output:g,onChangeLvl:ae,isSelected:ie,isDisabled:re,outputClasses:ce,format:f,provideGetterElements:e=>d(((...t)=>e(h.TIDs,...t)))};let C=()=>Promise.prototype;const k=(0,o.iH)(!1),E=(0,o.iH)(!1),O=(0,o.iH)(""),U=(0,o.iH)({text:p("COPY"),color:"yellow"}),T=(0,l.Fl)((()=>p(n.titleKey))),D=(0,l.Fl)((()=>Object.keys(g.total.result))),V=(0,l.Fl)((()=>`${location.origin}${location.pathname}`));if(r.Z.currentRoute.value.query.d){const e=h.parseUrl(r.Z.currentRoute.value.query.d),t={actually:{...e},plan:{...e}};h.add(t,{temporary:!0})}function B(e){C=e}function Q(){t("update:input",h.selectedConfig)}function X(e){(0,l.Y3)((()=>y(n.input,e)))}function ee(){Q(),X()}async function te(e){if("all"==e.target.name)await C("Reset all ? Are you serious ?").then((()=>{for(const e in n.input)e in n.input&&(h.selectedConfig[e]={})})).catch((()=>{}));else if(n.input.plan)for(const t in n.input.plan)t in n.input.plan&&(h.selectedConfig.plan[t]=n.input.actually[t]);X(),h.save()}async function ne(){const{name:e}=h.store.configs[h.store.selected];await C(p("REMOVE_CONFIG",[e])).then((()=>{h.removeSelected(),ee()})).catch((()=>{}))}async function le(){let e={};O.value&&await h.parseString(O.value).then((t=>e=t)).catch((e=>{alert(e.message),console.error(e)})),h.add({actually:{...e},plan:{...e}}),O.value="",E.value=!1,ee()}function oe(){const e=h.stringifyUrl();navigator.clipboard.writeText(`${V.value}?d=${e}`).then((()=>{U.value={text:p("COPIED"),color:"green"},setTimeout((()=>U.value={text:p("COPY"),color:"yellow"}),2e3)})).catch((e=>{U.value={text:p("Error"),color:"red"},alert(e.message),console.error(e)}))}function se(e,t){const n=g.total.intermediate[t];if("plan"==e)return{"yellow-color plus":n.plan,hide:0==n.plan};if("sum"==e){const e=n.sum>n.actually;return{"green-color ":e,muffle:!e,hide:0==n.sum}}return{}}function ae(e,t,l){return l="string"===typeof l?parseInt(l):l,0==l?(delete n.input[e][t],delete g[e][t]):h.selectedConfig[e][t]=l,Q(),X(t),h.save(),l}function ie(e,t,l){let o=n.input.plan[t]||0;const s=n.input.actually[t];return s>o&&(o=ae("plan",t,s)),"plan"==e?l==o:n.input[e][t]==l}function re(e,t,l){return!("plan"!=e||!n.input.actually)&&l<n.input.actually[t]}function ce(e,t,l){if("actually"==e)return{none:l&&D.value.includes(l),actually:!0};if("plan"==e){const o=l?g[e][t][l]:void 0;return{"yellow-color":(!n.input.actually[t]||n.input.plan[t]>n.input.actually[t])&&"object"!==typeof o,plus:!l||l&&!D.value.includes(l),none:n.input.plan[t]==n.input.actually[t],plan:!0}}return{}}return ee(),t("setup",b),(e,t)=>{const n=(0,l.Q2)("t");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)((0,o.SU)(c.Fb),null,{default:(0,l.w5)((()=>[(0,l._)("title",null,(0,s.zw)(T.value),1)])),_:1}),(0,l._)("h1",I,(0,s.zw)(T.value),1),(0,l._)("table",j,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,o.SU)(g).total.intermediate,((e,t)=>((0,l.wg)(),(0,l.iD)("tr",{key:t},[(0,l._)("td",{class:(0,s.C_)([(0,o.SU)(w.Z)(t),"stats-style"])},(0,s.zw)(f.key(t)),3),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e,((e,n)=>((0,l.wg)(),(0,l.iD)("td",{key:t+n,class:(0,s.C_)(se(n,t))},(0,s.zw)(e.toLocaleString("ru-RU")),3)))),128))])))),128)),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,o.SU)(g).total.result,((e,t)=>((0,l.wg)(),(0,l.iD)("tr",{key:t,class:"result"},[(0,l._)("td",{class:(0,s.C_)([(0,o.SU)(w.Z)(t),"stats-style"])},(0,s.zw)(f.key(t)),3),e>0?((0,l.wg)(),(0,l.iD)("td",R,[(0,l._)("b",null,(0,s.zw)(f.value(t,e)),1)])):(0,l.kq)("",!0)])))),128))]),(0,l._)("div",Z,[(0,l._)("button",{class:"settings",onClick:t[0]||(t[0]=e=>k.value=!0)}),(0,l._)("div",x,[(0,l._)("button",{class:"button yellow",name:"plan",onClick:te},(0,s.zw)(e.$t("RESET_PLAN")),1),(0,l._)("button",{class:"button red",name:"all",onClick:te},(0,s.zw)(e.$t("RESET_ALL")),1)])]),(0,l.Wm)(u.Z,{open:k.value,"onUpdate:open":[t[5]||(t[5]=e=>k.value=e),t[6]||(t[6]=()=>(0,o.SU)(h).save())],title:e.$t("CALCULATOR_SETTINGS"),size:(0,o.SU)(u.z).MEDIUM},{body:(0,l.w5)((()=>[(0,l._)("div",z,[(0,l._)("div",L,[(0,l.wy)((0,l._)("p",null,null,512),[[n,"CONFIG"]]),(0,l._)("div",K,[(0,l._)("button",{class:(0,s.C_)(`button ${U.value.color}`),onClick:oe},(0,s.zw)(U.value.text),3),(0,l.wy)((0,l._)("button",{class:"button green",onClick:t[1]||(t[1]=e=>E.value=!0)},null,512),[[n,"CREATE"]])])]),(0,l._)("div",$,[(0,l.wy)((0,l._)("p",N,null,512),[[n,"LIST"]]),(0,l.wy)((0,l._)("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>(0,o.SU)(h).store.selected=e),onChange:t[3]||(t[3]=e=>ee())},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,o.SU)(h).store.configs,((e,t)=>((0,l.wg)(),(0,l.iD)("option",{key:t,value:t},(0,s.zw)(e.name),9,H)))),128))],544),[[a.bM,(0,o.SU)(h).store.selected]])]),(0,l._)("div",M,[(0,l.wy)((0,l._)("p",F,null,512),[[n,"TID_CHANGE_NAME_TITLE"]]),(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>(0,o.SU)(h).store.configs[(0,o.SU)(h).store.selected].name=e),placeholder:e.$t("TID_CORP_NAME_LABEL")},null,8,G),[[a.nr,(0,o.SU)(h).store.configs[(0,o.SU)(h).store.selected].name]])]),(0,l._)("div",P,[(0,l.wy)((0,l._)("button",{class:"button red",onClick:ne},null,512),[[n,"TID_SOCIAL_DELETE_MESSAGE"]])])])])),_:1},8,["open","title","size"]),(0,l.Wm)(_,{onSetShow:B}),(0,l.Wm)(u.Z,{open:E.value,"onUpdate:open":t[8]||(t[8]=e=>E.value=e),title:e.$t("CREATE"),size:(0,o.SU)(u.z).SMALL},{body:(0,l.w5)((()=>[(0,l._)("div",Y,[(0,l.wy)((0,l._)("p",q,null,512),[[n,"FROM_TEXT_FORMAT"]]),J,(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>O.value=e)},null,512),[[a.nr,O.value]])]),(0,l._)("div",W,[(0,l.wy)((0,l._)("button",{class:"button green",onClick:le},null,512),[[n,"TID_OK"]])])])),_:1},8,["open","title","size"])])}}}),B=(0,y.Z)(V,[["__scopeId","data-v-8ca73278"]]),Q=B}}]);